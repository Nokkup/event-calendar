(this["webpackJsonptodo-calendar"]=this["webpackJsonptodo-calendar"]||[]).push([[0],{242:function(e,t){},364:function(e,t,n){"use strict";n.r(t);var c=n(0),r=n(35),a=n.n(r),s=n(42),i=n(94),o=n(172),u=n(212),j=n(37),l="SET_AUTH",b="SET_IS_LOADING",d="SET_USER",O="SET_EVENTS",h="ADD_EVENT",f={isAuth:!1,isLoading:!1,user:{}};var p=n(70),x={events:[]};var v,m,g,y,w,E={auth:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:f,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case l:return Object(j.a)(Object(j.a)({},e),{},{isAuth:t.payload,isLoading:!1});case d:return Object(j.a)(Object(j.a)({},e),{},{user:t.payload});case b:return Object(j.a)(Object(j.a)({},e),{},{isLoading:t.payload});default:return e}},event:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:x,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case O:return Object(j.a)(Object(j.a)({},e),{},{events:t.payload});case h:return Object(j.a)(Object(j.a)({},e),{},{events:[].concat(Object(p.a)(e.events),[t.payload])});default:return e}}},I=Object(o.b)(E),S=Object(o.c)(I,Object(o.a)(u.a)),C=n(366),k=n(3),A=n.n(k),L=n(9),T=n(118),Y=n(213),D=n(92),F=Object(Y.a)({apiKey:"AIzaSyB2E558TemYWU1CSdFvpCmApx7yvjijVnE",authDomain:"fir-event-calendar.firebaseapp.com",projectId:"fir-event-calendar",storageBucket:"fir-event-calendar.appspot.com",messagingSenderId:"997548526244",appId:"1:997548526244:web:5c895d4b66b9ce28b4f431",databaseURL:"https://fir-event-calendar-default-rtdb.europe-west1.firebasedatabase.app"}),U=Object(T.b)(F),P=Object(D.c)(F),M=Object(D.d)(P),z=n(226),B={setUser:function(e){return{type:d,payload:e}},setIsAuth:function(e){return{type:l,payload:e}},setIsLoading:function(e){return{type:b,payload:e}},login:function(e,t){return function(){var n=Object(L.a)(A.a.mark((function n(c){return A.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:c(B.setIsLoading(!0)),Object(T.d)(U,e,t).then((function(e){var t=e.user;c(B.setUser({email:t.email,uid:t.uid})),c(B.setIsAuth(!0)),c(B.setIsLoading(!1))})).catch((function(e){z.b.error("\u041d\u0435\u043f\u0440\u0430\u0432\u0438\u043b\u044c\u043d\u044b\u0439 \u043b\u043e\u0433\u0438\u043d \u0438\u043b\u0438 \u043f\u0430\u0440\u043e\u043b\u044c"),c(B.setIsLoading(!1))}));case 2:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}()},logout:function(){return function(){var e=Object(L.a)(A.a.mark((function e(t){return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:U.signOut(),t(B.setUser({})),t(B.setIsAuth(!1));case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},registration:function(e,t){return function(){var n=Object(L.a)(A.a.mark((function n(c){return A.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:Object(T.a)(U,e,t).then((function(n){c(B.login(e,t))})).catch((function(e){z.b.error(e.message)}));case 1:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}()},signedInUser:function(){return function(){var e=Object(L.a)(A.a.mark((function e(t){return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:Object(T.c)(U,(function(e){e&&(t(B.setUser({email:e.email,uid:e.uid})),t(B.setIsAuth(!0)))}));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}},q=n(39),_=n(33),N=n(22),R=n(119),V=n(372),G=n(377),H=n(76),J=n(79),K=n(231),W=n(186),Q={setEvents:function(e){return{type:O,payload:e}},addEvent:function(e){return{type:h,payload:e}},uploadEvents:function(){return function(){var e=Object(L.a)(A.a.mark((function e(t,n){var c,r,a,s,i;return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:c=n(),r=c.auth,a=c.event,s=Object(W.MD5)(r.user.email).toString(),i=a.events.slice(),Object(D.e)(Object(D.d)(P,s),{events:i}).then((function(){t(Q.setEvents(i))})).catch((function(e){console.error.toString(e)}));case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},getEvents:function(){return function(){var e=Object(L.a)(A.a.mark((function e(t,n){var c,r,a;return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:c=n(),r=c.auth,a=Object(W.MD5)(r.user.email).toString(),Object(D.b)(Object(D.a)(M,a)).then((function(e){var n=e.exists()?e.val().events:[];t(Q.setEvents(n))})).catch((function(e){console.error(e)}));case 3:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()}},X=n(77),Z=n(376),$=n(369),ee=n(370),te=n(354),ne=n(171),ce=n(168),re=n(74),ae=n(58),se=n.n(ae),ie=n(78),oe="planned",ue="done",je="cancelled",le=n(12),be=ie.a.ul(v||(v=Object(X.a)(["\n    margin: 0;\n    padding: 0;\n    list-style: none;\n"]))),de=ie.a.li.attrs((function(e){return{className:e.status}}))(m||(m=Object(X.a)(["\n    width: 100%;\n    overflow: hidden;\n    font-size: 14px;\n    white-space: nowrap;\n    text-overflow: ellipsis;\n    color: ",';\n\n    ::before {\n        content: "\u25cf ";\n    }\n\n    &.done {\n        ::before {\n            color: green;\n        }\n    }\n\n    &.cancelled {\n        ::before {\n            color: red;\n        }\n    }\n\n    &.planned {\n        ::before {\n            color: gold;\n        }\n    }\n'])),(function(e){return e.isPastEvents?"lightblue":"blue"})),Oe=function(e){var t=e.events,n=Object(c.useState)(!1),r=Object(_.a)(n,2),a=r[0],i=r[1],o=Object(c.useState)([]),u=Object(_.a)(o,2),l=u[0],b=u[1],d=Object(c.useState)(""),O=Object(_.a)(d,2),h=O[0],f=O[1],p=Object(s.b)();return Object(le.jsxs)(le.Fragment,{children:[Object(le.jsx)(Z.a,{fullscreen:!0,style:{width:"800px",zIndex:1},dateCellRender:function(e){var n=e.format("YYYY-MM-DD"),c=t.filter((function(e){return e.date===n})),r=e.isSameOrBefore(se()());return Object(le.jsx)(be,{children:c.map((function(e,t){return Object(le.jsx)(de,{isPastEvents:r,status:e.status,children:e.description},t)}))})},onSelect:function(e){var n=e.format("YYYY-MM-DD"),c=t.map((function(e,t){return Object(j.a)(Object(j.a)({},e),{},{id:t})})).filter((function(e){return e.date===n}));c.length>0&&(i(!0),b(c),f(n))}}),Object(le.jsx)(V.a,{title:"\u0421\u043e\u0431\u044b\u0442\u0438\u044f \u043d\u0430 ".concat(h),visible:a,footer:null,onCancel:function(){return i(!1)},children:Object(le.jsx)($.b,{itemLayout:"vertical",dataSource:l,pagination:{pageSize:3},renderItem:function(e){return Object(le.jsxs)($.b.Item,{children:[Object(le.jsx)(ee.a.Paragraph,{editable:{onChange:function(n){return function(e,n){if(e.length){var c=t.slice(),r=l.map((function(t){return t.id===n.id?Object(j.a)(Object(j.a)({},t),{},{description:e}):t}));c[n.id].description=e,b(r),p(Q.setEvents(c)),p(Q.uploadEvents())}else z.b.error("\u0414\u043e\u0431\u0430\u0432\u044c\u0442\u0435 \u043e\u043f\u0438\u0441\u0430\u043d\u0438\u0435")}(n,e)}},style:{width:"100%"},children:e.description}),Object(le.jsx)(R.a,{justify:"end",children:Object(le.jsxs)(te.a.Group,{size:"small",buttonStyle:"solid",value:e.status,onChange:function(n){return function(e,n){var c=e.target.value,r=t.slice(),a=l.map((function(e){return e.id===n.id?Object(j.a)(Object(j.a)({},e),{},{status:c}):e}));r[n.id].status=c,b(a),p(Q.setEvents(r)),p(Q.uploadEvents())}(n,e)},children:[Object(le.jsx)(te.a.Button,{value:oe,children:Object(le.jsx)(ne.a,{})}),Object(le.jsx)(te.a.Button,{value:ue,children:Object(le.jsx)(ce.a,{})}),Object(le.jsx)(te.a.Button,{value:je,children:Object(le.jsx)(re.a,{})})]})})]},e.id)}})})]})},he=n(368),fe=n(373),pe=n(371),xe=function(e){var t=e.submit,n=he.a.useForm(),r=Object(_.a)(n,1)[0],a=Object(c.useState)({date:"",description:"",status:oe}),s=Object(_.a)(a,2),i=s[0],o=s[1];return Object(le.jsxs)(he.a,{form:r,onFinish:function(){t(i),o({date:"",description:"",status:oe}),r.resetFields()},labelCol:{span:6},children:[Object(le.jsx)(he.a.Item,{label:"\u041e\u043f\u0438\u0441\u0430\u043d\u0438\u0435:",name:"decription",rules:[{required:!0,message:"\u0414\u043e\u0431\u0430\u0432\u044c\u0442\u0435 \u043e\u043f\u0438\u0441\u0430\u043d\u0438\u0435 \u0441\u043e\u0431\u044b\u0442\u0438\u044f"}],children:Object(le.jsx)(fe.a.TextArea,{rows:5,value:i.description,onChange:function(e){return o(Object(j.a)(Object(j.a)({},i),{},{description:e.target.value}))}})}),Object(le.jsx)(he.a.Item,{label:"\u0414\u0430\u0442\u0430:",name:"date",rules:[{required:!0,message:"\u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u0434\u0430\u0442\u0443"},function(){return{validator:function(e,t){return(null===t||void 0===t?void 0:t.isSameOrAfter(se()()))||!t?Promise.resolve():Promise.reject(new Error("\u0412\u044b\u0431\u0440\u0430\u043d\u043d\u0430\u044f \u0434\u0430\u0442\u0430 \u0443\u0436\u0435 \u043f\u0440\u043e\u0448\u043b\u0430"))}}}],children:Object(le.jsx)(pe.a,{onChange:function(e){return o(Object(j.a)(Object(j.a)({},i),{},{date:null===e||void 0===e?void 0:e.format("YYYY-MM-DD")}))}})}),Object(le.jsx)(R.a,{justify:"end",children:Object(le.jsx)(he.a.Item,{children:Object(le.jsx)(J.a,{type:"primary",htmlType:"submit",children:"\u0421\u043e\u0437\u0434\u0430\u0442\u044c"})})})]})},ve=(n(355),n(221)),me=n.n(ve),ge=function(){var e=Object(s.b)(),t=Object(c.useState)(!1),n=Object(_.a)(t,2),r=n[0],a=n[1],i=Object(s.c)((function(e){return e.event})).events;Object(c.useEffect)((function(){e(Q.getEvents())}),[]);return Object(le.jsxs)(C.a,{children:[Object(le.jsxs)(N.b,{locale:me.a,children:[Object(le.jsx)(R.a,{justify:"center",children:Object(le.jsx)(Oe,{events:i})}),Object(le.jsx)(V.a,{title:"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u043d\u043e\u0432\u043e\u0435 \u0441\u043e\u0431\u044b\u0442\u0438\u0435",visible:r,footer:null,onCancel:function(){return a(!1)},children:Object(le.jsx)(xe,{submit:function(t){a(!1),e(Q.addEvent(t)),e(Q.uploadEvents()),z.b.success("\u0421\u043e\u0431\u044b\u0442\u0438\u0435 \u0434\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u043e")}})})]}),Object(le.jsx)(G.a,{style:{position:"fixed",bottom:20,right:20,zIndex:10},children:Object(le.jsx)(H.a,{placement:"left",title:"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u043d\u043e\u0432\u043e\u0435 \u0441\u043e\u0431\u044b\u0442\u0438\u0435",children:Object(le.jsx)(J.a,{type:"primary",size:"large",shape:"circle",onClick:function(){return a(!0)},icon:Object(le.jsx)(K.a,{})})})})]})},ye=n(367),we=function(){var e=Object(s.c)((function(e){return e.auth})).isLoading,t=he.a.useForm(),n=Object(_.a)(t,1)[0],r=Object(c.useState)(""),a=Object(_.a)(r,2),o=a[0],u=a[1],j=Object(c.useState)(""),l=Object(_.a)(j,2),b=l[0],d=l[1],O=Object(s.b)();return Object(le.jsxs)(he.a,{name:"login",form:n,onFinish:function(){O(B.login(o,b))},children:[Object(le.jsx)(he.a.Item,{name:"email",rules:[{required:!0,message:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 email"}],children:Object(le.jsx)(fe.a,{value:o,onChange:function(e){return u(e.target.value)},placeholder:"Email"})}),Object(le.jsx)(he.a.Item,{name:"password",rules:[{required:!0,message:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u043f\u0430\u0440\u043e\u043b\u044c"}],children:Object(le.jsx)(fe.a.Password,{value:b,placeholder:"Password",onChange:function(e){return d(e.target.value)}})}),Object(le.jsxs)(he.a.Item,{children:[Object(le.jsx)(J.a,{type:"primary",htmlType:"submit",loading:e,style:{width:"100%"},children:"Login"}),Object(le.jsx)("span",{children:"Or "}),Object(le.jsx)(i.b,{to:"/registration",children:"register"})]}),Object(le.jsx)(H.a,{title:"\u0442\u0435\u0441\u0442\u043e\u0432\u044b\u0439 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c",children:Object(le.jsx)(J.a,{type:"dashed",htmlType:"button",onClick:function(){var e="test@test.test",t="testpass";n.setFieldsValue({email:e,password:t}),u(e),d(t)},children:"test user"})})]})},Ee=ie.a.div(g||(g=Object(X.a)(["\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    height: calc(100vh - 128px);\n"]))),Ie=function(){return Object(le.jsx)(C.a,{children:Object(le.jsx)(Ee,{children:Object(le.jsx)(ye.a,{children:Object(le.jsx)(we,{})})})})},Se=function(){var e=Object(c.useState)(""),t=Object(_.a)(e,2),n=t[0],r=t[1],a=Object(c.useState)(""),o=Object(_.a)(a,2),u=o[0],j=o[1],l=Object(s.b)();return Object(le.jsxs)(he.a,{name:"registration",onFinish:function(){l(B.registration(n,u))},children:[Object(le.jsx)(he.a.Item,{name:"email",rules:[{required:!0,message:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 email"}],children:Object(le.jsx)(fe.a,{value:n,onChange:function(e){return r(e.target.value)},placeholder:"Email"})}),Object(le.jsx)(he.a.Item,{name:"password",rules:[{required:!0,message:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u043f\u0430\u0440\u043e\u043b\u044c"}],children:Object(le.jsx)(fe.a.Password,{value:u,placeholder:"Password",onChange:function(e){return j(e.target.value)}})}),Object(le.jsxs)(he.a.Item,{children:[Object(le.jsx)(J.a,{type:"primary",htmlType:"submit",style:{width:"100%"},children:"Registration"}),Object(le.jsx)("span",{children:"Or "}),Object(le.jsx)(i.b,{to:"/login",children:"login"})]})]})},Ce=ie.a.div(y||(y=Object(X.a)(["\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    height: calc(100vh - 128px);\n"]))),ke=function(){return Object(le.jsx)(C.a,{children:Object(le.jsx)(Ce,{children:Object(le.jsx)(ye.a,{children:Object(le.jsx)(Se,{})})})})},Ae=function(){return Object(s.c)((function(e){return e.auth})).isAuth?Object(le.jsxs)(q.d,{children:[Object(le.jsx)(q.b,{path:"/",exact:!0,component:ge}),Object(le.jsx)(q.a,{to:"/"})]}):Object(le.jsxs)(q.d,{children:[Object(le.jsx)(q.b,{path:"/registration",exact:!0,component:ke}),Object(le.jsx)(q.b,{path:"/login",exact:!0,component:Ie}),Object(le.jsx)(q.a,{to:"/login"})]})},Le=n(378),Te=n(374),Ye=n(375),De=n(379),Fe=ie.a.div(w||(w=Object(X.a)(["\n    color: white;\n    max-width: 160px;\n    overflow: hidden;\n    text-overflow: ellipsis;\n"]))),Ue=function(){var e=Object(s.b)(),t=Object(s.c)((function(e){return e.auth})),n=t.isAuth,c=t.user;return Object(le.jsx)(C.a.Header,{children:Object(le.jsx)(R.a,{justify:"end",children:n&&Object(le.jsxs)(Le.b,{children:[Object(le.jsx)(Te.a,{icon:Object(le.jsx)(De.a,{})}),Object(le.jsx)(Fe,{children:c.email}),Object(le.jsx)(Ye.a,{theme:"dark",mode:"inline",inlineCollapsed:!1,selectable:!1,children:Object(le.jsx)(Ye.a.Item,{onClick:function(){return e(B.logout())},children:"Logout"},1)})]})})})},Pe=function(){return Object(le.jsx)(C.a.Footer,{children:Object(le.jsx)(R.a,{justify:"center",children:Object(le.jsxs)(Le.b,{children:[Object(le.jsx)("span",{children:"\xa92021"}),Object(le.jsx)("a",{href:"https://github.com/Nokkup/event-calendar",children:"Github"})]})})})},Me=function(){var e=Object(s.b)();return Object(c.useEffect)((function(){e(B.signedInUser())}),[]),Object(le.jsxs)(C.a,{children:[Object(le.jsx)(Ue,{}),Object(le.jsx)(C.a.Content,{children:Object(le.jsx)(Ae,{})}),Object(le.jsx)(Pe,{})]})};n(363);a.a.render(Object(le.jsx)(s.a,{store:S,children:Object(le.jsx)(i.a,{basename:"/event-calendar",children:Object(le.jsx)(Me,{})})}),document.getElementById("root"))}},[[364,1,2]]]);
//# sourceMappingURL=main.d52cc75b.chunk.js.map